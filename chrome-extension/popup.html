<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AISIS Auto Scraper</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --logo-spacing: -0.04em;
            
            /* Ateneo Blue Theme */
            --primary-h: 228;
            --primary-s: 74%;
            --primary-l: 30%;
            
            --background: 0 0% 100%;
            --foreground: 220 90% 8%;
            --card: 0 0% 100%;
            --card-foreground: 220 90% 8%;
            --primary: var(--primary-h) var(--primary-s) var(--primary-l);
            --primary-foreground: 0 0% 100%;
            --secondary: 220 14% 96%;
            --secondary-foreground: 220 90% 8%;
            --muted: 220 14% 96%;
            --muted-foreground: 220 9% 46%;
            --border: 220 13% 91%;
            --input: 220 13% 91%;
            --success: 142 76% 36%;
            --warning: 38 92% 50%;
            --radius: 0.5rem;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        html, body {
            width: 420px;
            height: 700px;
            min-width: 420px;
            max-width: 420px;
            min-height: 700px;
            max-height: 700px;
            overflow: hidden;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', sans-serif;
            font-size: 14px;
            line-height: 1.5;
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            display: flex;
            flex-direction: column;
        }

        .header {
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            padding: 0 24px;
            height: 64px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid hsl(var(--border));
            flex-shrink: 0;
        }

        .popup-content {
            flex: 1 1 auto;
            overflow-x: hidden;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            scrollbar-width: none;
            padding-bottom: 20px;
        }

        .popup-content::-webkit-scrollbar {
            display: none;
        }

        .session-info {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 2px;
        }

        .session-label {
            font-size: 9px;
            color: hsl(var(--muted-foreground));
            text-transform: uppercase;
            font-weight: 600;
        }

        .session-id {
            font-size: 10px;
            color: hsl(var(--foreground));
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            font-weight: 500;
            max-width: 280px;
            word-break: break-all;
            text-align: right;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo-icon {
            font-size: 1.35rem;
            font-weight: 700;
            color: hsl(var(--primary));
            letter-spacing: var(--logo-spacing, -0.05em);
            line-height: 1;
            position: relative;
            top: 2px;
        }
        
        .section {
            padding: 16px 20px;
            border-bottom: 1px solid hsl(var(--border));
        }
        
        .section-title {
            font-weight: 700;
            font-size: 13px;
            color: hsl(var(--muted-foreground));
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 12px;
        }
        
        .input-group {
            margin-bottom: 12px;
        }
        
        .input-group label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 6px;
            color: hsl(var(--foreground));
        }
        
        .input-group input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid hsl(var(--border));
            border-radius: calc(var(--radius) - 2px);
            font-family: inherit;
            font-size: 14px;
            background: hsl(var(--background));
            color: hsl(var(--foreground));
        }
        
        .input-group input:focus {
            outline: none;
            border-color: hsl(var(--primary));
            box-shadow: 0 0 0 2px hsl(var(--primary) / 0.1);
        }
        
        .btn-primary {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            white-space: nowrap;
            border-radius: calc(var(--radius) - 2px);
            font-size: 0.875rem;
            font-weight: 600;
            height: 2.5rem;
            padding: 0.5rem 1rem;
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            width: 100%;
            font-family: inherit;
        }
        
        .btn-primary:hover {
            background-color: hsl(var(--primary-h) var(--primary-s) calc(var(--primary-l) * 0.9));
        }
        
        .btn-outline {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            white-space: nowrap;
            border-radius: calc(var(--radius) - 2px);
            font-size: 0.875rem;
            font-weight: 600;
            height: 2.5rem;
            padding: 0.5rem 1rem;
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            border: 1px solid hsl(var(--border));
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
        }
        
        .btn-outline:hover {
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }
        
        .btn-sm {
            height: 2.25rem;
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
        }
        
        .select-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .select-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .select-group label {
            font-size: 13px;
            font-weight: 600;
            color: hsl(var(--foreground));
        }

        .page-select {
            width: 100%;
            border: 1px solid hsl(var(--border));
            border-radius: calc(var(--radius) - 2px);
            background: hsl(var(--background));
            color: hsl(var(--foreground));
            padding: 10px 12px;
            font-family: inherit;
            font-size: 13px;
            scrollbar-width: none;
        }

        .page-select::-webkit-scrollbar {
            display: none;
        }

        .page-select:focus {
            outline: none;
            border-color: hsl(var(--primary));
            box-shadow: 0 0 0 2px hsl(var(--primary) / 0.1);
        }

        .select-helper {
            margin-top: 10px;
            font-size: 11px;
            color: hsl(var(--muted-foreground));
        }
        
        .progress-section {
            padding: 16px 20px;
            background-color: hsl(var(--background));
            border-top: 1px solid hsl(var(--border));
            border-bottom: 1px solid hsl(var(--border));
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background-color: hsl(var(--muted));
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 10px;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background-color: hsl(var(--primary));
            transition: width 0.3s ease;
            display: block;
        }

        .progress-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 12px;
            font-weight: 600;
            color: hsl(var(--foreground));
        }

        .progress-value {
            font-variant-numeric: tabular-nums;
        }

        .progress-label {
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 11px;
            color: hsl(var(--muted-foreground));
        }

        .status-text {
            font-size: 13px;
            color: hsl(var(--muted-foreground));
            margin-bottom: 4px;
        }

        .time-estimate {
            font-size: 12px;
            color: hsl(var(--muted-foreground));
        }

        .logs-container {
            max-height: 200px;
            overflow-y: auto;
            background-color: hsl(var(--muted));
            border-radius: calc(var(--radius) - 2px);
            padding: 12px;
            font-size: 12px;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
        }
        
        .log-entry {
            padding: 4px 0;
            border-bottom: 1px solid hsl(var(--border));
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        .log-context {
            display: block;
            margin-top: 2px;
            color: hsl(var(--muted-foreground));
            font-size: 10px;
            opacity: 0.8;
        }

        .log-footnote {
            font-size: 11px;
            color: hsl(var(--muted-foreground));
            margin-top: 8px;
        }
        
        .log-info { color: hsl(var(--muted-foreground)); }
        .log-success { color: hsl(var(--success)); }
        .log-warning { color: hsl(var(--warning)); }
        .log-error { color: hsl(0 84.2% 60.2%); }
        .log-debug { color: hsl(var(--muted-foreground)); opacity: 0.7; }
        
        .export-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }
        
        .hidden {
            display: none;
        }
        
        .btn-group {
            display: flex;
            gap: 8px;
        }
        
        .btn-danger {
            background-color: hsl(0 84.2% 60.2%);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: hsl(0 84.2% 50.2%);
        }

    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="logo-container">
            <span class="logo-icon">sisia</span>
        </div>
        <div id="session-info" class="session-info hidden">
            <span class="session-label">AISIS Cookie</span>
            <span id="session-id" class="session-id"></span>
        </div>
    </div>

    <div class="popup-content">
    <!-- Credentials Section -->
    <div class="section" id="credentials-section">
        <div class="section-title">AISIS Credentials</div>
        <div class="input-group">
            <label for="username">Username</label>
            <input type="text" id="username" placeholder="Enter your AISIS username">
        </div>
        <div class="input-group">
            <label for="password">Password</label>
            <input type="password" id="password" placeholder="Enter your AISIS password">
        </div>
        <button id="save-credentials" class="btn-primary">Save Credentials</button>
    </div>
    
    <!-- Pages Selection -->
    <div class="section">
        <div class="section-title">Select Pages to Scrape</div>
        <div class="select-grid">
            <div class="select-group">
                <label for="academic-pages">Academic Records</label>
                <select id="academic-pages" class="page-select" multiple size="4">
                    <option value="scheduleOfClasses">Schedule of Classes</option>
                    <option value="officialCurriculum">Official Curriculum</option>
                    <option value="viewGrades">View Grades</option>
                    <option value="advisoryGrades">Advisory Grades</option>
                </select>
            </div>
            <div class="select-group">
                <label for="student-pages">Student &amp; Account</label>
                <select id="student-pages" class="page-select" multiple size="4">
                    <option value="currentlyEnrolled">Currently Enrolled Classes</option>
                    <option value="myClassSchedule">My Class Schedule</option>
                    <option value="tuitionReceipt">Tuition Receipt</option>
                    <option value="studentInfo">Student Information</option>
                </select>
            </div>
        </div>
        <div class="select-helper">Use Ctrl/Cmd or Shift to select multiple pages.</div>
    </div>
    
    <!-- Scraping Controls -->
    <div class="section">
        <div class="btn-group">
            <button id="start-scraping" class="btn-primary" style="flex: 1;">Start Scraping</button>
            <button id="stop-scraping" class="btn-outline btn-danger hidden" style="flex: 1;">Pause</button>
        </div>
    </div>
    
    <!-- Progress Section -->
    <div id="progress-section" class="progress-section hidden">
        <div class="progress-bar">
            <div id="progress-fill" class="progress-fill" style="width: 0%;"></div>
        </div>
        <div class="progress-meta">
            <span class="progress-label">Progress</span>
            <span id="progress-value" class="progress-value">0%</span>
        </div>
        <div id="status-text" class="status-text">Initializing...</div>
        <div id="time-estimate" class="time-estimate"></div>
    </div>

    <!-- Logs Section -->
    <div id="logs-section" class="section hidden">
        <div class="section-title">Debug Logs</div>
        <div id="logs-container" class="logs-container"></div>
        <div id="log-limit-notice" class="log-footnote hidden">Showing the last 500 events. Export the logs for the complete history.</div>
        <div class="btn-group" style="margin-top: 12px;">
            <button id="stop-scraping-logs" class="btn-outline btn-sm btn-danger">Pause</button>
            <button id="resume-scraping-logs" class="btn-outline btn-sm btn-success hidden">Resume Scraping</button>
            <button id="delete-logs" class="btn-outline btn-sm">Delete Logs</button>
        </div>
    </div>
    
    <!-- Export Section -->
    <div id="export-section" class="section hidden">
        <div class="section-title">Export Data</div>
        <div class="export-buttons">
            <button id="export-json" class="btn-outline">Export JSON</button>
            <button id="export-csv" class="btn-outline">Export CSV</button>
            <button id="view-data" class="btn-outline">View Data</button>
            <button id="download-logs" class="btn-outline">Download Logs</button>
            <button id="export-har" class="btn-outline">Export HAR</button>
            <button id="export-html" class="btn-outline">Export HTML</button>
        </div>
        <div style="margin-top: 12px; display: flex; flex-direction: column; gap: 8px;">
            <button id="hard-stop" class="btn-primary btn-danger" style="width: 100%;">Terminate Scraping (Cannot Resume)</button>
            <button id="clear-all-data" class="btn-outline" style="width: 100%;">Clear All Data & Start Fresh</button>
        </div>
    </div>

    </div>

    <script src="popup.js"></script>
</body>
</html>
